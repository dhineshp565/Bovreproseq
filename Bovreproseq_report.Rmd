---
title: "Bovreproseq Results Report"
date: "`r Sys.Date()`"
output:
  html_document: default
params:
  dire: " "
  krona_raw: " "
  cons: " "
  krona_consensus: " "
---

```{r setup, include=FALSE}
library(knitr)
library(ggplot2)
```

## No. of mapped reads
```{R, results='asis',echo=FALSE,fig.width = 10}
fi <- list.files(path=params$dire,pattern = "*_mappedreads.txt",full.names = T)
all_dfs <- lapply(fi, function(i){
  read.csv(i,header = TRUE,sep =" ")})
for (i in all_dfs){
  u<-i[,c(1,3)]
  print(knitr::kable(u))
  cat('\n\n<!-- -->\n\n')
  plot=ggplot(u,aes(x = !!rlang::sym(colnames(u)[1]),y = !!rlang::sym(colnames(u)[2])))+geom_bar(stat="identity",fill='darkgreen')+scale_y_log10()
  print(plot+coord_flip())
}
```

## kraken2 raw reads

```{r, echo=FALSE}
library("htmltools")
htmltools::tags$iframe(
  src = base64enc::dataURI(file=params$krona_raw, mime="text/html; charset=UTF-8"),
  style="border:10; position:relative; top:0; left:200px; right:; bottom:100px; width:70%; height:600px"
)
```

## kraken2 consensus
```{r, echo=FALSE}
library("htmltools")
htmltools::tags$iframe(
  src = base64enc::dataURI(file=params$krona_consensus, mime="text/html; charset=UTF-8"),
  style="border:10; position:relative; top:0; left:200px; right:; bottom:100px; width:70%; height:600px"
)
```

